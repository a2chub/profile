# 実装ロードマップ

## 現在の状況

> **注意**: このロードマップは当初の計画を示しています。
> Phase 0 は完了し、Phase 1 のメトリクス収集基盤は実装済みですが、
> 分析スクリプト（history-stats, history-patterns, weekly-report）は未実装です。
> 現在、dotfiles リポジトリ全体のリファクタリングを優先しています。

## 全体スケジュール（当初計画）

```
2024年12月                    2025年3月                    2025年6月
    │                            │                            │
    ▼                            ▼                            ▼
┌─────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────┐
│ Phase 0 │───▶│   Phase 1   │───▶│   Phase 2   │───▶│ Phase 3 │
│  準備   │    │ データ収集  │    │ エージェント │    │ 最適化  │
│  完了   │    │ 分析基盤    │    │ 設計・実装  │    │ 拡張    │
└─────────┘    └─────────────┘    └─────────────┘    └─────────┘
   2週間          延期中             延期中            未着手
```

---

## Phase 0: 準備（2週間）

### 目標
- 基盤となる設定とドキュメントの整備

### タスク

| # | タスク | 状態 | 完了日 |
|---|--------|------|--------|
| 0.1 | ヒストリー設定の追加 | [x] | 2024-12-29 |
| 0.2 | 月次アーカイブ機能 | [x] | 2024-12-29 |
| 0.3 | ドキュメント構造作成 | [x] | 2024-12-29 |
| 0.4 | 戦略文書の作成 | [x] | 2024-12-29 |
| 0.5 | 初期エイリアス追加 | [x] | 2025-01-10 |

### 成果物
- [x] `.zshrc` ヒストリー設定
- [x] `agent/docs/` ドキュメント
- [x] 基本エイリアス（gsync, drestart等）

---

## Phase 1: データ収集・分析基盤（1-2ヶ月）

### 目標
- ヒストリーデータの蓄積
- 分析ツールの整備

### マイルストーン

#### M1.1: 分析スクリプト v1（2週間）

```
agent/scripts/
├── history-stats      # 基本統計（頻出コマンド、日別推移）
└── history-patterns   # パターン検出（連続コマンド、時間帯）
```

**機能:**
- 頻出コマンド TOP 30
- 日別/時間帯別の使用傾向
- 2コマンド連続パターン

#### M1.2: メトリクス収集（3週間）✅ 実装済み

`.zshrc` に実装済み:
```zsh
# コマンド実行メトリクス
preexec() { ... }
precmd() { ... }
```

**収集データ:**
- 実行時刻
- 実行時間
- 終了コード
- 作業ディレクトリ
- コマンド内容

**保存先:** `~/.command_metrics.log`

#### M1.3: 週次レポート自動化（4週間）

```
agent/scripts/
└── weekly-report      # 週次サマリー生成
```

**出力:**
- 今週の作業パターン
- 新規検出パターン
- 自動化候補の提案

### 成果物チェックリスト

- [ ] `history-stats` スクリプト
- [ ] `history-patterns` スクリプト
- [x] メトリクス収集フック（preexec/precmd実装済み）
- [ ] `weekly-report` スクリプト
- [ ] 5,000行以上のヒストリー蓄積

---

## Phase 2: エージェント設計・実装（2-3ヶ月）

### 目標
- 汎用エージェントの稼働
- 専門エージェントの設計開始

### マイルストーン

#### M2.1: 汎用エージェント v1（3週間）

```
agent/agents/
├── git-sync.sh        # Git同期
├── docker-refresh.sh  # Docker再起動
└── dev-env-check.sh   # 開発環境確認
```

**実装方式:** シェルスクリプト（コスト0）

#### M2.2: Claude Code スキル（4週間）

```
agent/skills/
├── analyze-history/   # /analyze-history スキル
└── suggest-auto/      # /suggest-automation スキル
```

**機能:**
- ヒストリー分析レポート生成
- 自動化提案

#### M2.3: 専門エージェント v1（6週間）

```
agent/agents/
├── project-setup/     # 新規プロジェクト初期化
└── dependency-update/ # パッケージ更新
```

**実装方式:** Haiku/Sonnet エージェント

### 成果物チェックリスト

- [ ] 汎用エージェント 3個
- [ ] Claude Code スキル 2個
- [ ] 専門エージェント 1個
- [ ] エージェント使用ドキュメント

---

## Phase 3: 最適化・拡張（継続）

### 目標
- 効果測定と改善
- 新規パターンへの対応

### 継続タスク

| タスク | 頻度 |
|--------|------|
| メトリクス分析 | 週次 |
| エージェント効果測定 | 月次 |
| 新規パターン検出 | 月次 |
| コスト最適化レビュー | 四半期 |

### 拡張候補

**高度エージェント:**
- `code-review` - PRレビュー支援
- `debug-assistant` - デバッグ支援
- `architecture-advisor` - 設計相談

**統合:**
- MCPサーバーとしての実装
- IDE統合（VS Code, Cursor）
- Slack/Discord通知

---

## 依存関係

```
Phase 0 ──┬── ヒストリー設定 ──┐
          │                    │
          └── ドキュメント ────┼── Phase 1 ──┬── 分析スクリプト
                               │              │
                               │              └── メトリクス収集
                               │                       │
                               └───────────────────────┼── Phase 2
                                                       │
                                                       ▼
                                               汎用エージェント
                                                       │
                                                       ▼
                                               専門エージェント
                                                       │
                                                       ▼
                                                  Phase 3
```

---

## リスクと対策

| フェーズ | リスク | 対策 |
|---------|--------|------|
| Phase 1 | データ不足 | 最低2ヶ月の蓄積を待つ |
| Phase 1 | 分析精度 | 段階的に機能追加 |
| Phase 2 | 複雑化 | シンプルな実装から開始 |
| Phase 2 | コスト増 | Level選択基準の遵守 |
| Phase 3 | 保守負荷 | ドキュメント整備 |

---

## 更新履歴

| 日付 | 変更内容 |
|------|---------|
| 2024-12-29 | 初版作成、Phase 0完了 |
| 2025-01-10 | Phase 0完了（エイリアス追加）、Phase 1メトリクス収集実装済みを反映 |
| 2026-01-17 | 現状の実装状況を反映。Phase 1/2を「延期中」に更新。dotfilesリファクタリングを優先 |
